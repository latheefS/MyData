--------------------------------------------------------
--  DDL for View XXMX_PPM_PRJ_MISCCOST_RECON
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "XXMX_CORE"."XXMX_PPM_PRJ_MISCCOST_RECON" ("FILE_SET_ID", "MIGRATION_SET_ID", "MIGRATION_SET_NAME", "MIGRATION_STATUS", "BATCH_ID", "CREATION_DATE", "LAST_UPDATE_DATE", "CREATED_BY", "LAST_UPDATED_BY", "LAST_UPDATE_LOGIN", "TRANSACTION_TYPE", "BUSINESS_UNIT", "ORG_ID", "USER_TRANSACTION_SOURCE", "TRANSACTION_SOURCE_ID", "DOCUMENT_NAME", "DOCUMENT_ID", "DOC_ENTRY_NAME", "DOC_ENTRY_ID", "BATCH_NAME", "EXP_BATCH_NAME", "BATCH_ENDING_DATE", "BATCH_DESCRIPTION", "EXPENDITURE_ITEM_DATE", "PERSON_NUMBER", "PERSON_NAME", "PERSON_ID", "HCM_ASSIGNMENT_NAME", "HCM_ASSIGNMENT_ID", "PROJECT_NUMBER", "PROJECT_NAME", "PROJECT_ID", "TASK_NUMBER", "TASK_NAME", "TASK_ID", "EXPENDITURE_TYPE", "EXPENDITURE_TYPE_ID", "ORGANIZATION_NAME", "ORGANIZATION_ID", "QUANTITY", "UNIT_OF_MEASURE_NAME", "UNIT_OF_MEASURE", "WORK_TYPE", "WORK_TYPE_ID", "BILLABLE_FLAG", "CAPITALIZABLE_FLAG", "ACCRUAL_FLAG", "ORIG_TRANSACTION_REFERENCE", "UNMATCHED_NEGATIVE_TXN_FLAG", "REVERSED_ORIG_TXN_REFERENCE", "EXPENDITURE_COMMENT", "GL_DATE", "DENOM_CURRENCY_CODE", "DENOM_CURRENCY", "DENOM_RAW_COST", "DENOM_BURDENED_COST", "RAW_COST_CR_CCID", "RAW_COST_CR_ACCOUNT", "RAW_COST_DR_CCID", "RAW_COST_DR_ACCOUNT", "BURDENED_COST_CR_CCID", "BURDENED_COST_CR_ACCOUNT", "BURDENED_COST_DR_CCID", "BURDENED_COST_DR_ACCOUNT", "BURDEN_COST_CR_CCID", "BURDEN_COST_CR_ACCOUNT", "BURDEN_COST_DR_CCID", "BURDEN_COST_DR_ACCOUNT", "ACCT_CURRENCY_CODE", "ACCT_CURRENCY", "ACCT_RAW_COST", "ACCT_BURDENED_COST", "ACCT_RATE_TYPE", "ACCT_RATE_DATE", "ACCT_RATE_DATE_TYPE", "ACCT_EXCHANGE_RATE", "ACCT_EXCHANGE_ROUNDING_LIMIT", "CONVERTED_FLAG", "CONTEXT_CATEGORY", "USER_DEF_ATTRIBUTE1", "USER_DEF_ATTRIBUTE2", "USER_DEF_ATTRIBUTE3", "USER_DEF_ATTRIBUTE4", "USER_DEF_ATTRIBUTE5", "USER_DEF_ATTRIBUTE6", "USER_DEF_ATTRIBUTE7", "USER_DEF_ATTRIBUTE8", "USER_DEF_ATTRIBUTE9", "USER_DEF_ATTRIBUTE10", "FUNDING_SOURCE_ID", "RESERVED_ATTRIBUTE1", "RESERVED_ATTRIBUTE2", "RESERVED_ATTRIBUTE3", "RESERVED_ATTRIBUTE4", "RESERVED_ATTRIBUTE5", "RESERVED_ATTRIBUTE6", "RESERVED_ATTRIBUTE7", "RESERVED_ATTRIBUTE8", "RESERVED_ATTRIBUTE9", "RESERVED_ATTRIBUTE10", "ATTRIBUTE_CATEGORY", "ATTRIBUTE1", "ATTRIBUTE2", "ATTRIBUTE3", "ATTRIBUTE4", "ATTRIBUTE5", "ATTRIBUTE6", "ATTRIBUTE7", "ATTRIBUTE8", "ATTRIBUTE9", "ATTRIBUTE10", "CONTRACT_NUMBER", "CONTRACT_NAME", "CONTRACT_ID", "FUNDING_SOURCE_NUMBER", "FUNDING_SOURCE_NAME", "COST_TYPE", "BILL_GROUP", "AR_INVOICE_NUMBER", "PROJECT_CURRENCY_CODE", "PROJECT_RAW_COST", "ACCRUED_REVENUE", "ACCRUAL_RATE", "BILL_RATE", "BILL_JOB_BILLING_TITLE", "BILL_TRANS_CURRENCY_CODE", "BILL_TRANS_BILL_AMOUNT", "REVPROC_CURRENCY_CODE", "PROJFUNC_RAW_REVENUE", "RAW_REVENUE", "PROJECT_RAW_REVENUE", "BILL_TRANS_RAW_REVENUE", "PROJECT_REV_RATE_TYPE", "PROJECT_REV_RATE_DATE", "PROJECT_REV_EXCHANGE_RATE") AS 
  SELECT
        l."FILE_SET_ID",
        l."MIGRATION_SET_ID",
        l."MIGRATION_SET_NAME",
        l."MIGRATION_STATUS",
        l."BATCH_ID",
        l."CREATION_DATE",
        l."LAST_UPDATE_DATE",
        l."CREATED_BY",
        l."LAST_UPDATED_BY",
        l."LAST_UPDATE_LOGIN",
        l."TRANSACTION_TYPE",
        l."BUSINESS_UNIT",
        l."ORG_ID",
        l."USER_TRANSACTION_SOURCE",
        l."TRANSACTION_SOURCE_ID",
        l."DOCUMENT_NAME",
        l."DOCUMENT_ID",
        l."DOC_ENTRY_NAME",
        l."DOC_ENTRY_ID",
        l."BATCH_NAME",
        l."EXP_BATCH_NAME",
        l."BATCH_ENDING_DATE",
        l."BATCH_DESCRIPTION",
        l."EXPENDITURE_ITEM_DATE",
        l."PERSON_NUMBER",
        l."PERSON_NAME",
        l."PERSON_ID",
        l."HCM_ASSIGNMENT_NAME",
        l."HCM_ASSIGNMENT_ID",
        l."PROJECT_NUMBER",
        l."PROJECT_NAME",
        l."PROJECT_ID",
        l."TASK_NUMBER",
        l."TASK_NAME",
        l."TASK_ID",
        l."EXPENDITURE_TYPE",
        l."EXPENDITURE_TYPE_ID",
        l."ORGANIZATION_NAME",
        l."ORGANIZATION_ID",
        l."QUANTITY",
        l."UNIT_OF_MEASURE_NAME",
        l."UNIT_OF_MEASURE",
        l."WORK_TYPE",
        l."WORK_TYPE_ID",
        l."BILLABLE_FLAG",
        l."CAPITALIZABLE_FLAG",
        l."ACCRUAL_FLAG",
        l."ORIG_TRANSACTION_REFERENCE",
        l."UNMATCHED_NEGATIVE_TXN_FLAG",
        l."REVERSED_ORIG_TXN_REFERENCE",
        l."EXPENDITURE_COMMENT",
        l."GL_DATE",
        l."DENOM_CURRENCY_CODE",
        l."DENOM_CURRENCY",
        l."DENOM_RAW_COST",
        l."DENOM_BURDENED_COST",
        l."RAW_COST_CR_CCID",
        l."RAW_COST_CR_ACCOUNT",
        l."RAW_COST_DR_CCID",
        l."RAW_COST_DR_ACCOUNT",
        l."BURDENED_COST_CR_CCID",
        l."BURDENED_COST_CR_ACCOUNT",
        l."BURDENED_COST_DR_CCID",
        l."BURDENED_COST_DR_ACCOUNT",
        l."BURDEN_COST_CR_CCID",
        l."BURDEN_COST_CR_ACCOUNT",
        l."BURDEN_COST_DR_CCID",
        l."BURDEN_COST_DR_ACCOUNT",
        l."ACCT_CURRENCY_CODE",
        l."ACCT_CURRENCY",
        l."ACCT_RAW_COST",
        l."ACCT_BURDENED_COST",
        l."ACCT_RATE_TYPE",
        l."ACCT_RATE_DATE",
        l."ACCT_RATE_DATE_TYPE",
        l."ACCT_EXCHANGE_RATE",
        l."ACCT_EXCHANGE_ROUNDING_LIMIT",
        l."CONVERTED_FLAG",
        l."CONTEXT_CATEGORY",
        l."USER_DEF_ATTRIBUTE1",
        l."USER_DEF_ATTRIBUTE2",
        l."USER_DEF_ATTRIBUTE3",
        l."USER_DEF_ATTRIBUTE4",
        l."USER_DEF_ATTRIBUTE5",
        l."USER_DEF_ATTRIBUTE6",
        l."USER_DEF_ATTRIBUTE7",
        l."USER_DEF_ATTRIBUTE8",
        l."USER_DEF_ATTRIBUTE9",
        l."USER_DEF_ATTRIBUTE10",
        l."FUNDING_SOURCE_ID",
        l."RESERVED_ATTRIBUTE1",
        l."RESERVED_ATTRIBUTE2",
        l."RESERVED_ATTRIBUTE3",
        l."RESERVED_ATTRIBUTE4",
        l."RESERVED_ATTRIBUTE5",
        l."RESERVED_ATTRIBUTE6",
        l."RESERVED_ATTRIBUTE7",
        l."RESERVED_ATTRIBUTE8",
        l."RESERVED_ATTRIBUTE9",
        l."RESERVED_ATTRIBUTE10",
        l."ATTRIBUTE_CATEGORY",
        l."ATTRIBUTE1",
        l."ATTRIBUTE2",
        l."ATTRIBUTE3",
        l."ATTRIBUTE4",
        l."ATTRIBUTE5",
        l."ATTRIBUTE6",
        l."ATTRIBUTE7",
        l."ATTRIBUTE8",
        l."ATTRIBUTE9",
        (select p.ORGANIZATION_NAME from xxmx_stg.xxmx_ppm_projects_stg p where p.project_number = l.project_number) ATTRIBUTE10,
        l."CONTRACT_NUMBER",
        l."CONTRACT_NAME",
        l."CONTRACT_ID",
        l."FUNDING_SOURCE_NUMBER",
        l."FUNDING_SOURCE_NAME",
        l."COST_TYPE",
        l."BILL_GROUP",
        l."AR_INVOICE_NUMBER",
        e."PROJECT_CURRENCY_CODE",
        e."PROJECT_RAW_COST",
        accrued_revenue,
        accrual_rate,
        bill_rate,
        bill_job_billing_title,
        case when l.attribute10 is not null  then l.denom_currency_code 
             when l.attribute10 is null      then e.bill_trans_currency_code
             else e.bill_trans_currency_code
        end bill_trans_currency_code,
        case when l.attribute10 is not null  then l.denom_raw_cost 
             when l.attribute10 is null      then e.bill_trans_bill_amount
             else e.bill_trans_bill_amount
        end bill_trans_bill_amount,
        revproc_currency_code,
        projfunc_raw_revenue,
        raw_revenue,
        project_raw_revenue,
        bill_trans_raw_revenue,
        project_rev_rate_type,
        project_rev_rate_date,
        project_rev_exchange_rate
    FROM
        xxmx_pa_expenditure_items_all      e,
        xxmx_stg.xxmx_ppm_prj_misccost_stg l
    WHERE
        e.expenditure_item_id (+) = l.attribute1
;
  GRANT SELECT ON "XXMX_CORE"."XXMX_PPM_PRJ_MISCCOST_RECON" TO "XXMX_READONLY";
